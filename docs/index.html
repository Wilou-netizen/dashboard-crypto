<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>üìä Informe de mercado</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f9f9f9;
    }
    .moneda {
      margin-bottom: 15px;
      padding: 10px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 0 5px #ccc;
    }
    .accion {
      font-weight: bold;
    }
    pre {
      background: #eef;
      padding: 15px;
      border-radius: 8px;
      white-space: pre-wrap;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <h1>üìä Informe de mercado</h1>

  <!-- Informe completo generado por n8n -->
  <pre id="informe-mercado">Cargando informe...</pre>

  <!-- Hora de actualizaci√≥n -->
  <p id="hora">üïí Cargando hora...</p>

  <!-- Bloques individuales por moneda -->
  <div id="binancecoin" class="moneda"></div>
  <div id="bitcoin" class="moneda"></div>
  <div id="ethereum" class="moneda"></div>
  <div id="ripple" class="moneda"></div>
  <div id="solana" class="moneda"></div>
  <div id="tether" class="moneda"></div>

  <script>
    fetch("https://wilou99.app.n8n.cloud/webhook/dashboard-crypto")
      .then(response => response.json())
      .then(data => {
        // Mostrar el informe completo en el bloque <pre>
        const informe = data.informe;
        document.getElementById("informe-mercado").textContent = informe;

        // Extraer la hora del informe y mostrarla en <p id="hora">
        const lineas = informe.split("\n");
        const hora = lineas.find(linea => linea.startsWith("üïí"));
        if (hora) {
          document.getElementById("hora").textContent = hora;
        }

        // Mostrar cada moneda en su propio <div>
        const bloques = informe.split("\n\n").slice(1); // omitir encabezado
        bloques.forEach(bloque => {
          const nombre = bloque.split("\n")[0].replace("‚¨ÜÔ∏è ", "").toLowerCase();
          const div = document.getElementById(nombre);
          if (div) {
            div.innerHTML = bloque.replace(/\n/g, "<br>");
          }
        });
      })
      .catch(error => {
        console.error("Error al obtener el informe:", error);
        document.getElementById("informe-mercado").textContent = "Error al cargar el informe.";
      });
  </script>
</body>
</html>
